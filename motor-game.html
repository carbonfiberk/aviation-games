<!DOCTYPE html>
<html lang="tr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸš€ Motor Montaj SimÃ¼latÃ¶rÃ¼</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #0a1929, #1e3a5f, #0a1929);
            min-height: 100vh;
            color: white;
            overflow-x: hidden;
        }

        .game-title {
            font-family: 'Courier New', monospace;
            font-weight: bold;
            background: linear-gradient(to right, #06b6d4, #8b5cf6, #fb923c);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        /* Menu Screen */
        #menu-screen {
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .menu-container {
            text-align: center;
            max-width: 700px;
        }

        .menu-title {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }

        .menu-subtitle {
            color: #94a3b8;
            font-size: 1.1rem;
            margin-bottom: 40px;
        }

        .mode-buttons {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .mode-btn {
            background: linear-gradient(135deg, #f97316, #dc2626);
            padding: 3px;
            border-radius: 16px;
            border: none;
            cursor: pointer;
            transition: transform 0.3s, box-shadow 0.3s;
        }

        .mode-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 10px 40px rgba(249, 115, 22, 0.3);
        }

        .mode-btn.turbine {
            background: linear-gradient(135deg, #8b5cf6, #7c3aed);
        }

        .mode-btn.turbine:hover {
            box-shadow: 0 10px 40px rgba(139, 92, 246, 0.5);
        }

        .mode-btn-inner {
            background: #0a1929;
            border-radius: 14px;
            padding: 30px;
            min-height: 250px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }

        .mode-icon {
            font-size: 4rem;
            margin-bottom: 15px;
        }

        .mode-name {
            font-size: 1.5rem;
            font-weight: bold;
            margin-bottom: 8px;
            color: #ffffff;
            text-align: center;
        }

        .mode-desc {
            color: #cbd5e1;
            font-size: 0.9rem;
            text-align: center;
        }

        .rules-box {
            background: rgba(30, 41, 59, 0.5);
            border: 2px solid #334155;
            border-radius: 12px;
            padding: 20px;
            text-align: left;
        }

        .rules-title {
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: 12px;
        }

        .rules-list {
            color: #94a3b8;
            font-size: 0.9rem;
            line-height: 1.8;
        }

        /* Game Screen */
        #game-screen {
            display: none;
            height: 100vh;
        }

        .game-layout {
            display: flex;
            height: 100%;
        }

        /* Left Panel */
        .left-panel {
            width: 280px;
            background: rgba(10, 25, 41, 0.9);
            border-right: 1px solid #334155;
            padding: 16px;
            overflow-y: auto;
        }

        .panel-header {
            margin-bottom: 20px;
        }

        .panel-title {
            font-size: 1.2rem;
            font-weight: bold;
            margin-bottom: 8px;
        }

        .stats-row {
            display: flex;
            align-items: center;
            gap: 16px;
            font-size: 0.9rem;
        }

        .hearts {
            display: flex;
            gap: 4px;
        }

        .heart {
            font-size: 1.2rem;
        }

        .heart.empty {
            opacity: 0.3;
        }

        .score {
            color: #facc15;
            font-weight: bold;
        }

        .section-title {
            font-size: 1rem;
            font-weight: 600;
            color: #06b6d4;
            margin-bottom: 12px;
        }

        .locked-parts {
            background: rgba(22, 101, 52, 0.3);
            border: 2px solid rgba(34, 197, 94, 0.5);
            border-radius: 12px;
            padding: 12px;
            margin-bottom: 16px;
        }

        .locked-title {
            font-size: 0.85rem;
            font-weight: 600;
            color: #4ade80;
            margin-bottom: 8px;
        }

        .locked-item {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.75rem;
            color: #86efac;
            margin-bottom: 4px;
        }

        .color-dot {
            width: 12px;
            height: 12px;
            border-radius: 4px;
        }

        .parts-list {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .part-btn {
            width: 100%;
            padding: 12px;
            border-radius: 12px;
            border: 2px solid transparent;
            background: #1e293b;
            cursor: pointer;
            transition: all 0.2s;
            text-align: left;
        }

        .part-btn:hover {
            background: #334155;
            border-color: #475569;
        }

        .part-btn.selected {
            background: linear-gradient(to right, rgba(6, 182, 212, 0.3), rgba(139, 92, 246, 0.3));
            border-color: #8b5cf6;
            transform: scale(1.02);
        }

        .part-btn.disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .part-content {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .part-icon {
            width: 40px;
            height: 40px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
        }

        .part-info {
            flex: 1;
        }

        .part-name {
            font-size: 0.9rem;
            font-weight: 500;
            color: white;
        }

        .part-status {
            font-size: 0.75rem;
            color: #64748b;
        }

        .action-btn {
            width: 100%;
            padding: 14px;
            border: none;
            border-radius: 12px;
            font-size: 1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.2s;
            margin-top: 12px;
        }

        .undo-btn {
            background: linear-gradient(to right, #d97706, #ea580c);
            color: white;
        }

        .undo-btn:hover {
            background: linear-gradient(to right, #f59e0b, #f97316);
        }

        .check-btn {
            background: linear-gradient(to right, #22c55e, #10b981);
            color: white;
            box-shadow: 0 4px 20px rgba(34, 197, 94, 0.3);
        }

        .check-btn:hover {
            background: linear-gradient(to right, #4ade80, #34d399);
            transform: scale(1.02);
        }

        .retry-btn {
            background: linear-gradient(to right, #a855f7, #ec4899);
            color: white;
        }

        .retry-btn:hover {
            background: linear-gradient(to right, #c084fc, #f472b6);
        }

        /* Center - 3D View */
        .center-panel {
            flex: 1;
            position: relative;
        }

        #game-canvas {
            width: 100%;
            height: 100%;
        }

        .result-overlay {
            position: absolute;
            inset: 0;
            display: flex;
            align-items: flex-start;
            justify-content: center;
            padding-top: 30px;
            pointer-events: none;
        }

        .result-box {
            text-align: center;
            padding: 20px 32px;
            border-radius: 16px;
            backdrop-filter: blur(10px);
        }

        .result-box.success {
            background: rgba(34, 197, 94, 0.2);
            border: 2px solid #4ade80;
        }

        .result-box.partial {
            background: rgba(245, 158, 11, 0.2);
            border: 2px solid #fbbf24;
        }

        .result-box.failure {
            background: rgba(239, 68, 68, 0.2);
            border: 2px solid #f87171;
        }

        .result-icon {
            font-size: 3rem;
            margin-bottom: 10px;
        }

        .result-title {
            font-size: 1.4rem;
            font-weight: bold;
            margin-bottom: 6px;
        }

        .result-title.success {
            color: #4ade80;
        }

        .result-title.partial {
            color: #fbbf24;
        }

        .result-title.failure {
            color: #f87171;
        }

        .result-message {
            color: #cbd5e1;
            font-size: 0.9rem;
        }

        .selection-info {
            position: absolute;
            top: 16px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(10, 25, 41, 0.95);
            backdrop-filter: blur(10px);
            padding: 12px 24px;
            border-radius: 12px;
            border: 2px solid rgba(6, 182, 212, 0.6);
        }

        .selection-info span {
            color: #06b6d4;
            font-weight: 500;
        }

        /* Right Panel */
        .right-panel {
            width: 220px;
            background: rgba(10, 25, 41, 0.9);
            border-left: 1px solid #334155;
            padding: 16px;
        }

        .slots-list {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .slot-btn {
            width: 100%;
            padding: 12px;
            border-radius: 12px;
            border: 2px dashed #334155;
            background: rgba(30, 41, 59, 0.5);
            cursor: pointer;
            transition: all 0.2s;
        }

        .slot-btn:hover:not(.disabled):not(.filled) {
            background: rgba(6, 182, 212, 0.3);
            border-color: #06b6d4;
        }

        .slot-btn.active {
            background: rgba(6, 182, 212, 0.3);
            border: 2px dashed #06b6d4;
        }

        .slot-btn.filled {
            background: #1e293b;
            border: 2px solid #334155;
            cursor: default;
        }

        .slot-btn.locked {
            background: rgba(22, 101, 52, 0.3);
            border: 2px solid #22c55e;
            cursor: default;
        }

        .slot-btn.disabled {
            cursor: not-allowed;
        }

        .slot-content {
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .slot-label {
            font-size: 0.85rem;
            color: #94a3b8;
        }

        .slot-label.locked {
            color: #4ade80;
        }

        .slot-part {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .slot-part-name {
            font-size: 0.75rem;
            font-weight: 500;
            color: white;
            max-width: 80px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        .slot-part-name.locked {
            color: #86efac;
        }

        .slot-empty {
            font-size: 0.75rem;
            color: #475569;
        }

        .hint-box {
            margin-top: 20px;
            padding: 16px;
            background: rgba(30, 41, 59, 0.5);
            border: 2px solid #334155;
            border-radius: 12px;
        }

        .hint-title {
            font-size: 0.85rem;
            font-weight: 600;
            color: #facc15;
            margin-bottom: 8px;
        }

        .hint-text {
            font-size: 0.75rem;
            color: #94a3b8;
            line-height: 1.5;
        }

        .back-link {
            display: block;
            text-align: center;
            margin-top: 16px;
            padding: 12px 20px;
            background: linear-gradient(to right, #ef4444, #dc2626);
            color: #ffffff;
            font-size: 0.9rem;
            font-weight: bold;
            border: 2px solid #dc2626;
            border-radius: 12px;
            text-decoration: none;
            cursor: pointer;
            transition: all 0.3s;
        }

        .back-link:hover {
            background: linear-gradient(to right, #dc2626, #b91c1c);
            transform: scale(1.05);
            box-shadow: 0 4px 20px rgba(239, 68, 68, 0.4);
        }

        .empty-message {
            text-align: center;
            color: #64748b;
            font-size: 0.85rem;
            padding: 16px;
        }

        /* Tutorial Overlay */
        .tutorial-overlay {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.85);
            backdrop-filter: blur(5px);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 2000;
            animation: fadeIn 0.3s;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
            }

            to {
                opacity: 1;
            }
        }

        .tutorial-box {
            background: linear-gradient(to bottom, #1e3a5f, #0a1929);
            border: 2px solid #06b6d4;
            border-radius: 20px;
            padding: 40px;
            max-width: 600px;
            width: 90%;
            box-shadow: 0 20px 60px rgba(6, 182, 212, 0.5);
            animation: slideUp 0.4s;
        }

        @keyframes slideUp {
            from {
                transform: translateY(50px);
                opacity: 0;
            }

            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        .tutorial-header {
            text-align: center;
            margin-bottom: 30px;
        }

        .tutorial-title {
            font-size: 2rem;
            background: linear-gradient(to right, #06b6d4, #8b5cf6);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 10px;
        }

        .tutorial-subtitle {
            color: #94a3b8;
            font-size: 1rem;
        }

        .tutorial-steps {
            margin: 30px 0;
        }

        .tutorial-step {
            display: flex;
            align-items: flex-start;
            gap: 16px;
            margin-bottom: 20px;
            padding: 16px;
            background: rgba(30, 41, 59, 0.5);
            border-radius: 12px;
            border: 2px solid rgba(100, 116, 139, 0.3);
            transition: all 0.3s;
        }

        .tutorial-step:hover {
            background: rgba(30, 41, 59, 0.8);
            border-color: #06b6d4;
            transform: translateX(5px);
        }

        .tutorial-step-number {
            width: 36px;
            height: 36px;
            min-width: 36px;
            background: linear-gradient(135deg, #06b6d4, #8b5cf6);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 1.1rem;
        }

        .tutorial-step-content {
            flex: 1;
        }

        .tutorial-step-title {
            font-size: 1.1rem;
            font-weight: 600;
            color: #06b6d4;
            margin-bottom: 4px;
        }

        .tutorial-step-desc {
            color: #cbd5e1;
            font-size: 0.9rem;
            line-height: 1.5;
        }

        .tutorial-buttons {
            display: flex;
            gap: 12px;
            margin-top: 30px;
        }

        .tutorial-btn {
            flex: 1;
            padding: 14px 24px;
            border: none;
            border-radius: 12px;
            font-size: 1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
        }

        .tutorial-btn-primary {
            background: linear-gradient(to right, #06b6d4, #a855f7);
            color: white;
        }

        .tutorial-btn-primary:hover {
            transform: scale(1.05);
            box-shadow: 0 10px 30px rgba(168, 85, 247, 0.5);
        }

        .tutorial-btn-secondary {
            background: rgba(100, 116, 139, 0.3);
            color: #cbd5e1;
            border: 2px solid #475569;
        }

        .tutorial-btn-secondary:hover {
            background: rgba(100, 116, 139, 0.5);
        }

        /* Educational Content Overlay */
        .edu-overlay {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.9);
            backdrop-filter: blur(8px);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1500;
            animation: fadeIn 0.5s;
        }

        .edu-box {
            background: linear-gradient(135deg, #1e3a5f, #0a1929);
            border: 2px solid;
            border-radius: 20px;
            padding: 40px;
            max-width: 550px;
            width: 90%;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
            animation: slideUp 0.5s;
        }

        .edu-box.rocket {
            border-color: #f97316;
            box-shadow: 0 20px 60px rgba(249, 115, 22, 0.4);
        }

        .edu-box.turbine {
            border-color: #8b5cf6;
            box-shadow: 0 20px 60px rgba(139, 92, 246, 0.5);
        }

        .edu-header {
            text-align: center;
            margin-bottom: 25px;
        }

        .edu-icon {
            font-size: 4rem;
            margin-bottom: 15px;
        }

        .edu-title {
            font-size: 1.8rem;
            font-weight: bold;
            margin-bottom: 8px;
        }

        .edu-title.rocket {
            background: linear-gradient(to right, #f97316, #dc2626);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .edu-title.turbine {
            background: linear-gradient(to right, #06b6d4, #8b5cf6);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .edu-subtitle {
            color: #94a3b8;
            font-size: 0.95rem;
        }

        .edu-content {
            background: rgba(30, 41, 59, 0.5);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 25px;
        }

        .edu-fact {
            display: flex;
            gap: 12px;
            margin-bottom: 16px;
        }

        .edu-fact:last-child {
            margin-bottom: 0;
        }

        .edu-fact-icon {
            font-size: 1.3rem;
            min-width: 28px;
        }

        .edu-fact-text {
            color: #cbd5e1;
            line-height: 1.6;
            font-size: 0.95rem;
        }

        .edu-close-btn {
            width: 100%;
            padding: 14px;
            border: none;
            border-radius: 12px;
            font-size: 1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
        }

        .edu-close-btn.rocket {
            background: linear-gradient(to right, #f97316, #dc2626);
            color: white;
        }

        .edu-close-btn.turbine {
            background: linear-gradient(to right, #06b6d4, #8b5cf6);
            color: white;
        }

        .edu-close-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 10px 30px rgba(139, 92, 246, 0.5);
        }

        .edu-buttons {
            display: flex;
            gap: 10px;
        }

        .edu-share-btn {
            flex: 1;
            padding: 14px;
            border-radius: 12px;
            font-size: 1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            background: rgba(100, 116, 139, 0.3);
            color: #cbd5e1;
            border: 2px solid #475569;
        }

        .edu-share-btn:hover {
            background: rgba(100, 116, 139, 0.5);
            transform: scale(1.05);
        }

        /* Language Toggle Button */
        .lang-toggle {
            position: fixed;
            bottom: 20px;
            left: 20px;
            padding: 10px 18px;
            border-radius: 25px;
            background: linear-gradient(135deg, #f97316, #dc2626);
            border: 2px solid rgba(255, 255, 255, 0.3);
            cursor: pointer;
            font-size: 0.9rem;
            font-weight: bold;
            color: white;
            transition: all 0.3s;
            z-index: 1000;
            box-shadow: 0 4px 20px rgba(249, 115, 22, 0.4);
        }

        .lang-toggle:hover {
            transform: scale(1.05);
            box-shadow: 0 6px 30px rgba(249, 115, 22, 0.6);
        }

        /* Sound Toggle Button */
        .sound-toggle {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: linear-gradient(135deg, #10b981, #059669);
            border: 2px solid rgba(255, 255, 255, 0.3);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            transition: all 0.3s;
            z-index: 1000;
            box-shadow: 0 4px 20px rgba(16, 185, 129, 0.4);
        }

        .sound-toggle:hover {
            transform: scale(1.1);
            box-shadow: 0 6px 30px rgba(16, 185, 129, 0.6);
        }

        .sound-toggle.muted {
            background: linear-gradient(135deg, #64748b, #475569);
            box-shadow: 0 4px 20px rgba(100, 116, 139, 0.4);
        }

        @media (max-width: 900px) {
            .game-layout {
                flex-direction: column;
            }

            .left-panel,
            .right-panel {
                width: 100%;
                max-height: 30vh;
            }

            .center-panel {
                height: 40vh;
            }
        }
    </style>
</head>

<body>
    <button class="lang-toggle" id="lang-toggle" onclick="toggleLanguage()">ğŸŒ EN</button>

    <button class="sound-toggle" id="sound-toggle" onclick="toggleSound()" title="Toggle Sound">ğŸ”Š</button>

    <div class="edu-overlay" id="edu-overlay" style="display: none;">
        <div class="edu-box" id="edu-box">
            <div class="edu-header">
                <div class="edu-icon" id="edu-icon">ğŸš€</div>
                <div class="edu-title" id="edu-title">Roketler HakkÄ±nda</div>
                <div class="edu-subtitle">Ä°lginÃ§ Bilgiler</div>
            </div>

            <div class="edu-content" id="edu-content">
            </div>

            <div class="edu-buttons">
                <button class="edu-share-btn" onclick="shareResults()">
                    ğŸ“¸ PaylaÅŸ
                </button>
                <button class="edu-close-btn" id="edu-close-btn" onclick="closeEducationalContent()">
                    Devam Et ğŸ®
                </button>
            </div>
        </div>
    </div>

    <div class="tutorial-overlay" id="tutorial-overlay" style="display: none;">
        <div class="tutorial-box">
            <div class="tutorial-header">
                <div class="tutorial-title">ğŸ“ HoÅŸ Geldin!</div>
                <div class="tutorial-subtitle">Motor montaj oyununu Ã¶ÄŸrenelim</div>
            </div>

            <div class="tutorial-steps">
                <div class="tutorial-step">
                    <div class="tutorial-step-number">1</div>
                    <div class="tutorial-step-content">
                        <div class="tutorial-step-title">ğŸ“¦ ParÃ§a SeÃ§</div>
                        <div class="tutorial-step-desc">Sol panelden bir motor parÃ§asÄ± seÃ§</div>
                    </div>
                </div>

                <div class="tutorial-step">
                    <div class="tutorial-step-number">2</div>
                    <div class="tutorial-step-content">
                        <div class="tutorial-step-title">ğŸ¯ Slota YerleÅŸtir</div>
                        <div class="tutorial-step-desc">SaÄŸ paneldeki boÅŸ slotlardan birine tÄ±klayarak yerleÅŸtir</div>
                    </div>
                </div>

                <div class="tutorial-step">
                    <div class="tutorial-step-number">3</div>
                    <div class="tutorial-step-content">
                        <div class="tutorial-step-title">ğŸ”§ MontajÄ± Kontrol Et</div>
                        <div class="tutorial-step-desc">TÃ¼m parÃ§alarÄ± yerleÅŸtirdikten sonra "MontajÄ± Kontrol Et"
                            butonuna tÄ±kla</div>
                    </div>
                </div>

                <div class="tutorial-step">
                    <div class="tutorial-step-number">4</div>
                    <div class="tutorial-step-content">
                        <div class="tutorial-step-title">ğŸš€ BaÅŸarÄ±lÄ± Ol!</div>
                        <div class="tutorial-step-desc">DoÄŸru sÄ±ralama = BaÅŸarÄ±lÄ± uÃ§uÅŸ! YanlÄ±ÅŸ sÄ±ralama = Patlama! 3
                            hakkÄ±n var.</div>
                    </div>
                </div>
            </div>

            <div class="tutorial-buttons">
                <button class="tutorial-btn tutorial-btn-secondary" onclick="skipTutorial()">Atla</button>
                <button class="tutorial-btn tutorial-btn-primary" onclick="closeTutorial()">AnladÄ±m, BaÅŸlayalÄ±m!
                    ğŸ®</button>
            </div>
        </div>
    </div>

    <div id="menu-screen">
        <div class="menu-container">
            <h1 class="menu-title game-title">ğŸš€ MOTOR MONTAJ SÄ°MÃœLATÃ–RÃœ</h1>
            <p class="menu-subtitle">ParÃ§alarÄ± doÄŸru sÄ±rayla yerleÅŸtir ve aracÄ±nÄ± uÃ§ur!</p>

            <div class="mode-buttons">
                <button class="mode-btn" onclick="startGame('rocket')">
                    <div class="mode-btn-inner">
                        <div class="mode-icon">ğŸš€</div>
                        <div class="mode-name">ROKET</div>
                        <div class="mode-desc">Dikey montaj â€¢ 6 parÃ§a â€¢ Uzaya fÄ±rlat!</div>
                    </div>
                </button>

                <button class="mode-btn turbine" onclick="startGame('turbine')">
                    <div class="mode-btn-inner">
                        <div class="mode-icon">âœˆï¸</div>
                        <div class="mode-name">GAZ TÃœRBÄ°NÄ°</div>
                        <div class="mode-desc">Yatay montaj â€¢ 6 parÃ§a â€¢ UÃ§aÄŸÄ± havalandÄ±r!</div>
                    </div>
                </button>
            </div>

            <div class="rules-box">
                <div class="rules-title">ğŸ“‹ NASIL OYNANIR?</div>
                <div class="rules-list">
                    â€¢ Sol panelden parÃ§a seÃ§<br>
                    â€¢ SaÄŸ paneldeki slotlara tÄ±klayarak yerleÅŸtir<br>
                    â€¢ YanlÄ±ÅŸ yerleÅŸtirirsen geri al tuÅŸunu kullan<br>
                    â€¢ DoÄŸru sÄ±ralama = BaÅŸarÄ±lÄ± uÃ§uÅŸ ğŸ‰<br>
                    â€¢ YanlÄ±ÅŸ sÄ±ralama = Patlama! ğŸ’¥<br>
                    â€¢ 3 hakkÄ±n var, dikkatli ol!
                </div>
            </div>
        </div>
    </div>

    <div id="game-screen">
        <div class="game-layout">
            <div class="left-panel">
                <div class="panel-header">
                    <div class="panel-title game-title" id="game-mode-title">ğŸš€ ROKET</div>
                    <div class="stats-row">
                        <div class="hearts" id="hearts-display"></div>
                        <div class="score" id="score-display">â­ 0</div>
                    </div>
                </div>

                <div class="section-title">PARÃ‡ALAR</div>

                <div class="locked-parts" id="locked-parts-section" style="display: none;">
                    <div class="locked-title">ğŸ”’ DoÄŸru YerleÅŸtirildi</div>
                    <div id="locked-parts-list"></div>
                </div>

                <div class="parts-list" id="parts-list"></div>

                <div id="empty-parts-message" class="empty-message" style="display: none;">
                    TÃ¼m parÃ§alar yerleÅŸtirildi
                </div>

                <button class="action-btn undo-btn" id="undo-btn" style="display: none;" onclick="undoLastPlacement()">
                    â†©ï¸ GERÄ° AL
                </button>

                <button class="action-btn check-btn" id="check-btn" onclick="checkAssembly()">
                    ğŸ”§ MontajÄ± Kontrol Et
                </button>

                <button class="action-btn retry-btn" id="retry-btn" style="display: none;" onclick="resetGame()">
                    ğŸ”„ TEKRAR DENE
                </button>
            </div>

            <div class="center-panel">
                <div id="game-canvas"></div>

                <div class="selection-info" id="selection-info" style="display: none;">
                    SeÃ§ili: <span id="selected-part-name"></span>
                    <span style="color: #94a3b8; margin-left: 16px;">YerleÅŸtirmek iÃ§in bir slota tÄ±kla</span>
                </div>

                <div class="result-overlay" id="result-overlay" style="display: none;">
                    <div class="result-box" id="result-box">
                        <div class="result-icon" id="result-icon">ğŸ‰</div>
                        <div class="result-title" id="result-title">BAÅARILI!</div>
                        <div class="result-message" id="result-message">MÃ¼kemmel!</div>
                    </div>
                </div>
            </div>

            <div class="right-panel">
                <div class="section-title">MONTAJ SLOTLARI</div>

                <div class="slots-list" id="slots-list"></div>

                <div class="hint-box">
                    <div class="hint-title" id="hint-title">ğŸ’¡ Ä°PUCU</div>
                    <div class="hint-text" id="hint-text">
                        ParÃ§alarÄ± mantÄ±klÄ± bir sÄ±rayla dizmelisin!
                    </div>
                </div>

                <div class="back-link" id="back-to-menu-btn" onclick="goToMenu()">Ana MenÃ¼ye DÃ¶n</div>
            </div>
        </div>
    </div>

    <script>
        // Language System
        let currentLanguage = localStorage.getItem('motor_game_language') || 'tr';

        const translations = {
            tr: {
                // Menu
                menuTitle: 'ğŸš€ MOTOR MONTAJ SÄ°MÃœLATÃ–RÃœ',
                menuSubtitle: 'ParÃ§alarÄ± doÄŸru sÄ±rayla yerleÅŸtir ve aracÄ±nÄ± uÃ§ur!',
                rocketMode: 'ROKET',
                rocketDesc: 'Dikey montaj â€¢ 6 parÃ§a â€¢ Uzaya fÄ±rlat!',
                turbineMode: 'GAZ TÃœRBÄ°NÄ°',
                turbineDesc: 'Yatay montaj â€¢ 6 parÃ§a â€¢ UÃ§aÄŸÄ± havalandÄ±r!',
                rulesTitle: 'ğŸ“‹ NASIL OYNANIR?',
                rule1: 'â€¢ Sol panelden parÃ§a seÃ§',
                rule2: 'â€¢ SaÄŸ paneldeki slotlara tÄ±klayarak yerleÅŸtir',
                rule3: 'â€¢ YanlÄ±ÅŸ yerleÅŸtirirsen geri al tuÅŸunu kullan',
                rule4: 'â€¢ DoÄŸru sÄ±ralama = BaÅŸarÄ±lÄ± uÃ§uÅŸ ğŸ‰',
                rule5: 'â€¢ YanlÄ±ÅŸ sÄ±ralama = Patlama! ğŸ’¥',
                rule6: 'â€¢ 3 hakkÄ±n var, dikkatli ol!',

                // Tutorial
                tutorialTitle: 'ğŸ“ HoÅŸ Geldin!',
                tutorialSubtitle: 'Motor montaj oyununu Ã¶ÄŸrenelim',
                tutorialStep1Title: 'ğŸ“¦ ParÃ§a SeÃ§',
                tutorialStep1Desc: 'Sol panelden bir motor parÃ§asÄ± seÃ§',
                tutorialStep2Title: 'ğŸ¯ Slota YerleÅŸtir',
                tutorialStep2Desc: 'SaÄŸ paneldeki boÅŸ slotlardan birine tÄ±klayarak yerleÅŸtir',
                tutorialStep3Title: 'ğŸ”§ MontajÄ± Kontrol Et',
                tutorialStep3Desc: 'TÃ¼m parÃ§alarÄ± yerleÅŸtirdikten sonra "MontajÄ± Kontrol Et" butonuna tÄ±kla',
                tutorialStep4Title: 'ğŸš€ BaÅŸarÄ±lÄ± Ol!',
                tutorialStep4Desc: 'DoÄŸru sÄ±ralama = BaÅŸarÄ±lÄ± uÃ§uÅŸ! YanlÄ±ÅŸ sÄ±ralama = Patlama! 3 hakkÄ±n var.',
                tutorialSkip: 'Atla',
                tutorialStart: 'AnladÄ±m, BaÅŸlayalÄ±m! ğŸ®',

                // Educational Facts
                eduRocketTitle: 'Roketler HakkÄ±nda',
                eduTurbineTitle: 'Gaz TÃ¼rbinleri HakkÄ±nda',
                eduSubtitle: 'Ä°lginÃ§ Bilgiler',
                eduShare: 'ğŸ“¸ PaylaÅŸ',
                eduContinue: 'Devam Et ğŸ®',

                // Game UI
                parts: 'PARÃ‡ALAR',
                lockedTitle: 'ğŸ”’ DoÄŸru YerleÅŸtirildi',
                allPlaced: 'TÃ¼m parÃ§alar yerleÅŸtirildi',
                undoBtn: 'â†©ï¸ GERÄ° AL',
                checkBtn: 'ğŸ”§ MONTAJI KONTROL ET',
                retryBtn: 'ğŸ”„ TEKRAR DENE',
                menuBtn: 'ğŸ  ANA MENÃœ',
                assemblySlots: 'MONTAJ SLOTLARI',
                hintTitle: 'ğŸ’¡ Ä°PUCU',
                rocketHint: 'Roket parÃ§alarÄ± mantÄ±klÄ± bir sÄ±rayla dizilmeli. Hangi parÃ§a nerede olmalÄ± dÃ¼ÅŸÃ¼n!',
                turbineHint: 'TÃ¼rbin parÃ§alarÄ± akÄ±ÅŸ sÄ±rasÄ±na gÃ¶re dizilmeli. Hava nasÄ±l akar dÃ¼ÅŸÃ¼n!',
                backToMenu: 'Ana MenÃ¼ye DÃ¶n',
                selected: 'SeÃ§ili:',
                clickSlot: 'YerleÅŸtirmek iÃ§in bir slota tÄ±kla',
                slot: 'Slot',
                empty: 'BoÅŸ',
                ready: 'HazÄ±r',

                // Results
                successTitle: 'BAÅARILI FIRLATMA!',
                partialTitle: 'BAZI PARÃ‡ALAR YANLIÅ!',
                failureTitle: 'MONTAJ HATASI!',
                rocketSuccess: 'MÃ¼kemmel! Roketin uzaya fÄ±rladÄ±! +100 puan',
                turbineSuccess: 'MÃ¼kemmel! UÃ§ak havalandÄ±! +100 puan',
                partialMsg: 'DoÄŸru parÃ§alar yerinde kaldÄ±. YanlÄ±ÅŸ olanlarÄ± tekrar yerleÅŸtir!',
                failureMsg: 'ParÃ§alar yanlÄ±ÅŸ yerleÅŸtirildi!',
                livesLeft: 'hakkÄ±n kaldÄ±',
                gameOver: 'Oyun bitti!',
                placeAllParts: 'TÃ¼m parÃ§alarÄ± yerleÅŸtirin!',

                // Rocket Parts
                noseCone: 'Burun Konisi',
                payload: 'YÃ¼k BÃ¶lÃ¼mÃ¼',
                fuelTank: 'YakÄ±t TankÄ±',
                oxidizer: 'Oksitleyici Tank',
                engine: 'Roket Motoru',
                fins: 'KanatÃ§Ä±klar',

                // Turbine Parts
                intake: 'Hava GiriÅŸi',
                compressor: 'KompresÃ¶r',
                combustion: 'Yanma OdasÄ±',
                turbineBlades: 'TÃ¼rbin KanatlarÄ±',
                shaft: 'Ana Åaft',
                exhaust: 'Egzoz Nozulu',

                // Share
                shareTitle: 'Motor Montaj BaÅŸarÄ±m!',
                shareText: 'Skorum:',
                shareDownloaded: 'ğŸ“¸ Ekran gÃ¶rÃ¼ntÃ¼sÃ¼ indirildi!',
                shareError: 'PaylaÅŸÄ±m sÄ±rasÄ±nda bir hata oluÅŸtu.'
            },
            en: {
                // Menu
                menuTitle: 'ğŸš€ ENGINE ASSEMBLY SIMULATOR',
                menuSubtitle: 'Place parts in the correct order and launch your vehicle!',
                rocketMode: 'ROCKET',
                rocketDesc: 'Vertical assembly â€¢ 6 parts â€¢ Launch to space!',
                turbineMode: 'GAS TURBINE',
                turbineDesc: 'Horizontal assembly â€¢ 6 parts â€¢ Takeoff!',
                rulesTitle: 'ğŸ“‹ HOW TO PLAY?',
                rule1: 'â€¢ Select a part from the left panel',
                rule2: 'â€¢ Click on slots in the right panel to place',
                rule3: 'â€¢ Use undo button if you make a mistake',
                rule4: 'â€¢ Correct order = Successful flight ğŸ‰',
                rule5: 'â€¢ Wrong order = Explosion! ğŸ’¥',
                rule6: 'â€¢ You have 3 lives, be careful!',

                // Tutorial
                tutorialTitle: 'ğŸ“ Welcome!',
                tutorialSubtitle: "Let's learn the engine assembly game",
                tutorialStep1Title: 'ğŸ“¦ Select Part',
                tutorialStep1Desc: 'Choose an engine part from the left panel',
                tutorialStep2Title: 'ğŸ¯ Place in Slot',
                tutorialStep2Desc: 'Click on an empty slot in the right panel to place it',
                tutorialStep3Title: 'ğŸ”§ Check Assembly',
                tutorialStep3Desc: 'After placing all parts, click the "Check Assembly" button',
                tutorialStep4Title: 'ğŸš€ Succeed!',
                tutorialStep4Desc: 'Correct order = Successful flight! Wrong order = Explosion! You have 3 lives.',
                tutorialSkip: 'Skip',
                tutorialStart: "Got it, Let's Start! ğŸ®",

                // Educational Facts
                eduRocketTitle: 'About Rockets',
                eduTurbineTitle: 'About Gas Turbines',
                eduSubtitle: 'Interesting Facts',
                eduShare: 'ğŸ“¸ Share',
                eduContinue: 'Continue ğŸ®',

                // Game UI
                parts: 'PARTS',
                lockedTitle: 'ğŸ”’ Correctly Placed',
                allPlaced: 'All parts placed',
                undoBtn: 'â†©ï¸ UNDO',
                checkBtn: 'ğŸ”§ CHECK ASSEMBLY',
                retryBtn: 'ğŸ”„ TRY AGAIN',
                menuBtn: 'ğŸ  MAIN MENU',
                assemblySlots: 'ASSEMBLY SLOTS',
                hintTitle: 'ğŸ’¡ HINT',
                rocketHint: 'Rocket parts must be arranged in a logical order. Think about where each part should be!',
                turbineHint: 'Turbine parts must be arranged by airflow order. Think about how air flows!',
                backToMenu: 'Back to Menu',
                selected: 'Selected:',
                clickSlot: 'Click a slot to place',
                slot: 'Slot',
                empty: 'Empty',
                ready: 'Ready',

                // Results
                successTitle: 'SUCCESSFUL LAUNCH!',
                partialTitle: 'SOME PARTS ARE WRONG!',
                failureTitle: 'ASSEMBLY ERROR!',
                rocketSuccess: 'Perfect! Your rocket launched to space! +100 points',
                turbineSuccess: 'Perfect! The airplane took off! +100 points',
                partialMsg: 'Correct parts stayed in place. Re-place the wrong ones!',
                failureMsg: 'Parts placed incorrectly!',
                livesLeft: 'lives left',
                gameOver: 'Game over!',
                placeAllParts: 'Place all parts first!',

                // Rocket Parts
                noseCone: 'Nose Cone',
                payload: 'Payload Section',
                fuelTank: 'Fuel Tank',
                oxidizer: 'Oxidizer Tank',
                engine: 'Rocket Engine',
                fins: 'Fins',

                // Turbine Parts
                intake: 'Air Intake',
                compressor: 'Compressor',
                combustion: 'Combustion Chamber',
                turbineBlades: 'Turbine Blades',
                shaft: 'Main Shaft',
                exhaust: 'Exhaust Nozzle',

                // Share
                shareTitle: 'My Engine Assembly Success!',
                shareText: 'My Score:',
                shareDownloaded: 'ğŸ“¸ Screenshot downloaded!',
                shareError: 'An error occurred while sharing.'
            }
        };

        const educationalFacts = {
            tr: {
                rocket: [
                    { icon: 'ğŸš€', text: 'Roketler, atmosferdeki oksijene ihtiyaÃ§ duymadÄ±ÄŸÄ± iÃ§in uzayda Ã§alÄ±ÅŸabilir. Kendi oksitleyicilerini taÅŸÄ±rlar!' },
                    { icon: 'âš¡', text: 'Saturn V roketi, Ay\'a giden astronotlarÄ± taÅŸÄ±dÄ±. 110 metre yÃ¼ksekliÄŸinde ve 3000 ton aÄŸÄ±rlÄ±ÄŸÄ±ndaydÄ±!' },
                    { icon: 'ğŸ”¥', text: 'Roket motorlarÄ± saniyede 1.5 ton yakÄ±t tÃ¼ketebilir ve 3000Â°C\'ye kadar Ä±sÄ±nabilir!' },
                    { icon: 'ğŸŒ', text: 'Yer Ã§ekiminden kurtulmak iÃ§in roketlerin saniyede 11.2 km hÄ±za (40.000 km/saat) ulaÅŸmasÄ± gerekir!' },
                    { icon: 'ğŸ’«', text: 'SpaceX Falcon 9 roketi, geri dÃ¶nebilen ve tekrar kullanÄ±labilen ilk orbital roket oldu!' },
                    { icon: 'ğŸ¯', text: 'Roket parÃ§alarÄ± belirli bir sÄ±rayla Ã§alÄ±ÅŸÄ±r: YakÄ±t tanklarÄ± â†’ Motor â†’ KanatÃ§Ä±klar denge saÄŸlar!' }
                ],
                turbine: [
                    { icon: 'âœˆï¸', text: 'Gaz tÃ¼rbinleri, havayÄ± sÄ±kÄ±ÅŸtÄ±rarak yakÄ±t verimliliÄŸini artÄ±rÄ±r. Modern jetlerde %50\'ye kadar verim saÄŸlar!' },
                    { icon: 'ğŸ’¨', text: 'TÃ¼rbin kanatlarÄ±, ses hÄ±zÄ±nÄ±n 2 katÄ±ndan daha hÄ±zlÄ± dÃ¶nebilir (2400 km/saat)!' },
                    { icon: 'ğŸŒ¡ï¸', text: 'Yanma odasÄ± sÄ±caklÄ±ÄŸÄ± 1500Â°C\'yi aÅŸar, bu metalin erime noktasÄ±ndan daha yÃ¼ksektir!' },
                    { icon: 'âš™ï¸', text: 'Bir jet motoru saniyede 1.5 ton hava Ã§eker - bu bir salondaki tÃ¼m havayÄ± 1 saniyede deÄŸiÅŸtirebilir!' },
                    { icon: 'ğŸ”§', text: 'TÃ¼rbin kanatlarÄ±, gÃ¼Ã§lendirilmiÅŸ nikel alaÅŸÄ±mÄ±ndan yapÄ±lÄ±r ve tek kristal halinde bÃ¼yÃ¼tÃ¼lÃ¼r!' },
                    { icon: 'ğŸ“', text: 'Gaz tÃ¼rbini prensibi: Hava giriÅŸi â†’ SÄ±kÄ±ÅŸtÄ±rma â†’ Yanma â†’ GenleÅŸme â†’ Egzoz. Bu Brayton Ã§evrimi olarak bilinir!' }
                ]
            },
            en: {
                rocket: [
                    { icon: 'ğŸš€', text: 'Rockets can work in space because they don\'t need atmospheric oxygen. They carry their own oxidizers!' },
                    { icon: 'âš¡', text: 'Saturn V rocket carried astronauts to the Moon. It was 110 meters tall and weighed 3000 tons!' },
                    { icon: 'ğŸ”¥', text: 'Rocket engines can consume 1.5 tons of fuel per second and heat up to 3000Â°C!' },
                    { icon: 'ğŸŒ', text: 'To escape Earth\'s gravity, rockets must reach 11.2 km/s (40,000 km/h) - called escape velocity!' },
                    { icon: 'ğŸ’«', text: 'SpaceX Falcon 9 became the first orbital rocket that can return and be reused!' },
                    { icon: 'ğŸ¯', text: 'Rocket parts work in sequence: Fuel tanks â†’ Engine â†’ Fins provide stability!' }
                ],
                turbine: [
                    { icon: 'âœˆï¸', text: 'Gas turbines increase fuel efficiency by compressing air. Modern jets achieve up to 50% efficiency!' },
                    { icon: 'ğŸ’¨', text: 'Turbine blades can spin faster than twice the speed of sound (2400 km/h)!' },
                    { icon: 'ğŸŒ¡ï¸', text: 'Combustion chamber temperature exceeds 1500Â°C, higher than the melting point of metal!' },
                    { icon: 'âš™ï¸', text: 'A jet engine pulls 1.5 tons of air per second - enough to change all air in a room in 1 second!' },
                    { icon: 'ğŸ”§', text: 'Turbine blades are made from reinforced nickel alloy and grown as single crystals!' },
                    { icon: 'ğŸ“', text: 'Gas turbine principle: Air intake â†’ Compression â†’ Combustion â†’ Expansion â†’ Exhaust. Known as Brayton cycle!' }
                ]
            }
        };

        function t(key) {
            return translations[currentLanguage][key] || key;
        }

        function toggleLanguage() {
            playClick();
            currentLanguage = currentLanguage === 'tr' ? 'en' : 'tr';
            localStorage.setItem('motor_game_language', currentLanguage);
            document.getElementById('lang-toggle').textContent = currentLanguage === 'tr' ? 'ğŸŒ EN' : 'ğŸŒ TR';
            updateLanguage();
        }

        function updateLanguage() {
            // Update menu screen
            document.querySelector('.menu-title').textContent = t('menuTitle');
            document.querySelector('.menu-subtitle').textContent = t('menuSubtitle');

            // Update mode buttons
            const modeButtons = document.querySelectorAll('.mode-btn');
            if (modeButtons[0]) {
                modeButtons[0].querySelector('.mode-name').textContent = t('rocketMode');
                modeButtons[0].querySelector('.mode-desc').textContent = t('rocketDesc');
            }
            if (modeButtons[1]) {
                modeButtons[1].querySelector('.mode-name').textContent = t('turbineMode');
                modeButtons[1].querySelector('.mode-desc').textContent = t('turbineDesc');
            }

            // Update rules
            document.querySelector('.rules-title').textContent = t('rulesTitle');
            const rulesList = document.querySelector('.rules-list');
            if (rulesList) {
                rulesList.innerHTML = `
                    ${t('rule1')}<br>
                    ${t('rule2')}<br>
                    ${t('rule3')}<br>
                    ${t('rule4')}<br>
                    ${t('rule5')}<br>
                    ${t('rule6')}
                `;
            }

            // Update tutorial
            document.querySelector('.tutorial-title').textContent = t('tutorialTitle');
            document.querySelector('.tutorial-subtitle').textContent = t('tutorialSubtitle');
            const tutSteps = document.querySelectorAll('.tutorial-step-title');
            const tutDescs = document.querySelectorAll('.tutorial-step-desc');
            if (tutSteps[0]) tutSteps[0].textContent = t('tutorialStep1Title');
            if (tutDescs[0]) tutDescs[0].textContent = t('tutorialStep1Desc');
            if (tutSteps[1]) tutSteps[1].textContent = t('tutorialStep2Title');
            if (tutDescs[1]) tutDescs[1].textContent = t('tutorialStep2Desc');
            if (tutSteps[2]) tutSteps[2].textContent = t('tutorialStep3Title');
            if (tutDescs[2]) tutDescs[2].textContent = t('tutorialStep3Desc');
            if (tutSteps[3]) tutSteps[3].textContent = t('tutorialStep4Title');
            if (tutDescs[3]) tutDescs[3].textContent = t('tutorialStep4Desc');

            const tutBtns = document.querySelectorAll('.tutorial-btn');
            if (tutBtns[0]) tutBtns[0].textContent = t('tutorialSkip');
            if (tutBtns[1]) tutBtns[1].textContent = t('tutorialStart');

            // Update back to menu button
            const backBtn = document.getElementById('back-to-menu-btn');
            if (backBtn) backBtn.textContent = t('backToMenu');

            // Update check button
            const checkBtn = document.getElementById('check-btn');
            if (checkBtn) checkBtn.textContent = t('checkBtn');

            // Update hint title
            const hintTitle = document.getElementById('hint-title');
            if (hintTitle) hintTitle.textContent = t('hintTitle');

            // Update game mode title if in game
            if (gameMode && gameState !== 'menu') {
                const gameModeTitle = document.getElementById('game-mode-title');
                if (gameModeTitle) {
                    gameModeTitle.textContent = gameMode === 'rocket' ? `ğŸš€ ${t('rocketMode')}` : `âœˆï¸ ${t('turbineMode')}`;
                }
            }

            // Update game UI if in game
            if (gameState !== 'menu') {
                updateUI();
            }
        }

        // Sound System
        let audioContext = null;
        let isSoundEnabled = true;
        let backgroundMusicGain = null;
        let backgroundOscillator = null;

        function initAudioContext() {
            if (!audioContext) {
                audioContext = new (window.AudioContext || window.webkitAudioContext)();
            }
            return audioContext;
        }

        function playTone(frequency, duration, type = 'sine', volume = 0.1) {
            if (!isSoundEnabled) return;
            const ctx = initAudioContext();

            const oscillator = ctx.createOscillator();
            const gainNode = ctx.createGain();

            oscillator.type = type;
            oscillator.frequency.setValueAtTime(frequency, ctx.currentTime);

            gainNode.gain.setValueAtTime(volume, ctx.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.01, ctx.currentTime + duration);

            oscillator.connect(gainNode);
            gainNode.connect(ctx.destination);

            oscillator.start(ctx.currentTime);
            oscillator.stop(ctx.currentTime + duration);
        }

        function playClick() {
            if (!isSoundEnabled) return;
            playTone(800, 0.1, 'square', 0.2);
        }

        function playSelect() {
            if (!isSoundEnabled) return;
            playTone(600, 0.15, 'sine', 0.25);
            setTimeout(() => playTone(800, 0.1, 'sine', 0.2), 50);
        }

        function playPlace() {
            if (!isSoundEnabled) return;
            playTone(400, 0.2, 'triangle', 0.3);
            setTimeout(() => playTone(600, 0.15, 'triangle', 0.25), 100);
        }

        function playSuccess() {
            if (!isSoundEnabled) return;
            const notes = [523, 659, 784, 1047]; // C, E, G, C (major chord)
            notes.forEach((freq, i) => {
                setTimeout(() => playTone(freq, 0.1, 'sine', 0.1), i * 100);
            });
        }

        function playFailure() {
            if (!isSoundEnabled) return;
            playTone(200, 0.5, 'sawtooth', 0.4);
            setTimeout(() => playTone(150, 0.5, 'sawtooth', 0.35), 100);
            setTimeout(() => playTone(100, 0.6, 'sawtooth', 0.3), 200);
        }

        function playPartial() {
            if (!isSoundEnabled) return;
            playTone(400, 0.3, 'square', 0.3);
            setTimeout(() => playTone(350, 0.3, 'square', 0.25), 150);
        }

        function playRocketLaunch() {
            if (!isSoundEnabled) return;
            const ctx = initAudioContext();

            // Low rumble
            const rumble = ctx.createOscillator();
            const rumbleGain = ctx.createGain();
            rumble.type = 'sawtooth';
            rumble.frequency.setValueAtTime(80, ctx.currentTime);
            rumble.frequency.exponentialRampToValueAtTime(120, ctx.currentTime + 3);
            rumbleGain.gain.setValueAtTime(0.4, ctx.currentTime);
            rumbleGain.gain.exponentialRampToValueAtTime(0.01, ctx.currentTime + 3);
            rumble.connect(rumbleGain);
            rumbleGain.connect(ctx.destination);
            rumble.start();
            rumble.stop(ctx.currentTime + 3);

            // High frequency crackle
            for (let i = 0; i < 20; i++) {
                setTimeout(() => {
                    if (isSoundEnabled) {
                        playTone(Math.random() * 2000 + 1000, 0.05, 'square', 0.1);
                    }
                }, i * 150);
            }
        }

        function playTurbineSpinup() {
            if (!isSoundEnabled) return;
            const ctx = initAudioContext();

            const whine = ctx.createOscillator();
            const whineGain = ctx.createGain();
            whine.type = 'sawtooth';
            whine.frequency.setValueAtTime(100, ctx.currentTime);
            whine.frequency.exponentialRampToValueAtTime(1200, ctx.currentTime + 2);
            whineGain.gain.setValueAtTime(0.1, ctx.currentTime);
            whineGain.gain.setValueAtTime(0.1, ctx.currentTime + 2);
            whineGain.gain.exponentialRampToValueAtTime(0.01, ctx.currentTime + 4);
            whine.connect(whineGain);
            whineGain.connect(ctx.destination);
            whine.start();
            whine.stop(ctx.currentTime + 4);
        }

        function startBackgroundMusic() {
            if (!isSoundEnabled || backgroundOscillator) return;
            const ctx = initAudioContext();

            backgroundOscillator = ctx.createOscillator();
            backgroundMusicGain = ctx.createGain();

            backgroundOscillator.type = 'sine';
            backgroundOscillator.frequency.setValueAtTime(110, ctx.currentTime); // Low A note
            backgroundMusicGain.gain.setValueAtTime(0.05, ctx.currentTime);

            backgroundOscillator.connect(backgroundMusicGain);
            backgroundMusicGain.connect(ctx.destination);
            backgroundOscillator.start();
        }

        function stopBackgroundMusic() {
            if (backgroundOscillator) {
                backgroundOscillator.stop();
                backgroundOscillator = null;
                backgroundMusicGain = null;
            }
        }

        function toggleSound() {
            isSoundEnabled = !isSoundEnabled;
            const btn = document.getElementById('sound-toggle');
            btn.textContent = isSoundEnabled ? 'ğŸ”Š' : 'ğŸ”‡';
            btn.classList.toggle('muted', !isSoundEnabled);
            btn.title = isSoundEnabled ? 'Mute Sound' : 'Unmute Sound';

            if (!isSoundEnabled) {
                stopBackgroundMusic();
            } else {
                if (gameState !== 'menu') {
                    startBackgroundMusic();
                }
                playClick();
            }
        }

        // Educational Content System
        const rocketFacts = [
            { icon: 'ğŸš€', text: 'Roketler, atmosferdeki oksijene ihtiyaÃ§ duymadÄ±ÄŸÄ± iÃ§in uzayda Ã§alÄ±ÅŸabilir. Kendi oksitleyicilerini taÅŸÄ±rlar!' },
            { icon: 'âš¡', text: 'Saturn V roketi, Ay\'a giden astronotlarÄ± taÅŸÄ±dÄ±. 110 metre yÃ¼ksekliÄŸinde ve 3000 ton aÄŸÄ±rlÄ±ÄŸÄ±ndaydÄ±!' },
            { icon: 'ğŸ”¥', text: 'Roket motorlarÄ± saniyede 1.5 ton yakÄ±t tÃ¼ketebilir ve 3000Â°C\'ye kadar Ä±sÄ±nabilir!' },
            { icon: 'ğŸŒ', text: 'Yer Ã§ekiminden kurtulmak iÃ§in roketlerin saniyede 11.2 km hÄ±za (40.000 km/saat) ulaÅŸmasÄ± gerekir!' },
            { icon: 'ğŸ’«', text: 'SpaceX Falcon 9 roketi, geri dÃ¶nebilen ve tekrar kullanÄ±labilen ilk orbital roket oldu!' },
            { icon: 'ğŸ¯', text: 'Roket parÃ§alarÄ± belirli bir sÄ±rayla Ã§alÄ±ÅŸÄ±r: YakÄ±t tanklarÄ± â†’ Motor â†’ KanatÃ§Ä±klar denge saÄŸlar!' }
        ];

        const turbineFacts = [
            { icon: 'âœˆï¸', text: 'Gaz tÃ¼rbinleri, havayÄ± sÄ±kÄ±ÅŸtÄ±rarak yakÄ±t verimliliÄŸini artÄ±rÄ±r. Modern jetlerde %50\'ye kadar verim saÄŸlar!' },
            { icon: 'ğŸ’¨', text: 'TÃ¼rbin kanatlarÄ±, ses hÄ±zÄ±nÄ±n 2 katÄ±ndan daha hÄ±zlÄ± dÃ¶nebilir (2400 km/saat)!' },
            { icon: 'ğŸŒ¡ï¸', text: 'Yanma odasÄ± sÄ±caklÄ±ÄŸÄ± 1500Â°C\'yi aÅŸar, bu metalin erime noktasÄ±ndan daha yÃ¼ksektir!' },
            { icon: 'âš™ï¸', text: 'Bir jet motoru saniyede 1.5 ton hava Ã§eker - bu bir salondaki tÃ¼m havayÄ± 1 saniyede deÄŸiÅŸtirebilir!' },
            { icon: 'ğŸ”§', text: 'TÃ¼rbin kanatlarÄ±, gÃ¼Ã§lendirilmiÅŸ nikel alaÅŸÄ±mÄ±ndan yapÄ±lÄ±r ve tek kristal halinde bÃ¼yÃ¼tÃ¼lÃ¼r!' },
            { icon: 'ğŸ“', text: 'Gaz tÃ¼rbini prensibi: Hava giriÅŸi â†’ SÄ±kÄ±ÅŸtÄ±rma â†’ Yanma â†’ GenleÅŸme â†’ Egzoz. Bu Brayton Ã§evrimi olarak bilinir!' }
        ];

        function showEducationalContent() {
            const factsKey = gameMode === 'rocket' ? 'rocket' : 'turbine';
            const facts = educationalFacts[currentLanguage][factsKey];
            const randomFacts = getRandomFacts(facts, 3);

            const eduOverlay = document.getElementById('edu-overlay');
            const eduBox = document.getElementById('edu-box');
            const eduIcon = document.getElementById('edu-icon');
            const eduTitle = document.getElementById('edu-title');
            const eduSubtitle = document.querySelector('.edu-subtitle');
            const eduContent = document.getElementById('edu-content');
            const eduCloseBtn = document.getElementById('edu-close-btn');
            const eduShareBtn = document.querySelector('.edu-share-btn');

            // Set icon and title
            eduIcon.textContent = gameMode === 'rocket' ? 'ğŸš€' : 'âœˆï¸';
            eduTitle.textContent = gameMode === 'rocket' ? t('eduRocketTitle') : t('eduTurbineTitle');
            eduSubtitle.textContent = t('eduSubtitle');

            // Set appropriate classes
            eduBox.className = `edu-box ${gameMode}`;
            eduTitle.className = `edu-title ${gameMode}`;
            eduCloseBtn.className = `edu-close-btn ${gameMode}`;

            // Update button text
            eduShareBtn.textContent = t('eduShare');
            eduCloseBtn.textContent = t('eduContinue');

            // Build facts HTML
            eduContent.innerHTML = randomFacts.map(fact => `
                <div class="edu-fact">
                    <div class="edu-fact-icon">${fact.icon}</div>
                    <div class="edu-fact-text">${fact.text}</div>
                </div>
            `).join('');

            // Show overlay
            eduOverlay.style.display = 'flex';
        }

        function getRandomFacts(factsArray, count) {
            const shuffled = [...factsArray].sort(() => Math.random() - 0.5);
            return shuffled.slice(0, count);
        }

        function closeEducationalContent() {
            playClick();
            document.getElementById('edu-overlay').style.display = 'none';
        }

        // Share Results System
        async function shareResults() {
            playClick();

            try {
                // Capture the canvas
                const canvas = renderer.domElement;
                const dataUrl = canvas.toDataURL('image/png');

                // Create a composite image with game info
                const compositeCanvas = document.createElement('canvas');
                compositeCanvas.width = 1200;
                compositeCanvas.height = 800;
                const ctx = compositeCanvas.getContext('2d');

                // Background gradient
                const gradient = ctx.createLinearGradient(0, 0, 0, 800);
                gradient.addColorStop(0, '#020617');
                gradient.addColorStop(0.5, '#1e1b4b');
                gradient.addColorStop(1, '#020617');
                ctx.fillStyle = gradient;
                ctx.fillRect(0, 0, 1200, 800);

                // Load and draw the 3D scene
                const img = new Image();
                img.src = dataUrl;
                await new Promise(resolve => {
                    img.onload = () => {
                        ctx.drawImage(img, 100, 100, 1000, 500);
                        resolve();
                    };
                });

                // Add title
                ctx.fillStyle = '#22d3ee';
                ctx.font = 'bold 48px Arial';
                ctx.textAlign = 'center';
                ctx.fillText(t('menuTitle'), 600, 60);

                // Add success message
                ctx.fillStyle = '#4ade80';
                ctx.font = 'bold 32px Arial';
                const modeText = gameMode === 'rocket' ? t('rocketSuccess') : t('turbineSuccess');
                ctx.fillText(modeText.replace(' +100 puan', '').replace(' +100 points', ''), 600, 680);

                // Add score
                ctx.fillStyle = '#facc15';
                ctx.font = 'bold 24px Arial';
                ctx.fillText(`â­ ${t('shareText')} ${score}`, 600, 730);

                // Convert to blob
                compositeCanvas.toBlob(async (blob) => {
                    const file = new File([blob], 'motor-montaj-basari.png', { type: 'image/png' });

                    // Try Web Share API first
                    if (navigator.share && navigator.canShare && navigator.canShare({ files: [file] })) {
                        try {
                            await navigator.share({
                                title: t('shareTitle'),
                                text: `${modeText} ${t('shareText')} ${score}`,
                                files: [file]
                            });
                            return;
                        } catch (shareError) {
                            if (shareError.name === 'AbortError') {
                                return; // User cancelled
                            }
                            // Fall through to download
                        }
                    }

                    // Fallback to download
                    const link = document.createElement('a');
                    link.download = 'motor-montaj-basari.png';
                    link.href = URL.createObjectURL(blob);
                    link.click();
                    URL.revokeObjectURL(link.href);

                    // Show feedback
                    alert(t('shareDownloaded'));
                }, 'image/png');

            } catch (error) {
                console.error('Share error:', error);
                alert(t('shareError'));
            }
        }

        // Tutorial System
        function showTutorial() {
            document.getElementById('tutorial-overlay').style.display = 'flex';
        }

        function closeTutorial() {
            playClick();
            document.getElementById('tutorial-overlay').style.display = 'none';
            localStorage.setItem('motor_game_tutorial_completed', 'true');
        }

        function skipTutorial() {
            playClick();
            document.getElementById('tutorial-overlay').style.display = 'none';
            localStorage.setItem('motor_game_tutorial_skipped', 'true');
        }

        function checkFirstTime() {
            const completed = localStorage.getItem('motor_game_tutorial_completed');
            const skipped = localStorage.getItem('motor_game_tutorial_skipped');
            return !completed && !skipped;
        }

        // Game State
        let gameMode = null;
        let lives = 3;
        let score = 0;
        let placedParts = {};
        let selectedPart = null;
        let shuffledParts = [];
        let placementHistory = [];
        let lockedSlots = new Set();
        let gameState = 'menu';
        let result = null;

        // Three.js
        let scene, camera, renderer, animationId;
        let objects = {};

        // Parts Data
        const ROCKET_PARTS = [
            { id: 'nose_cone', nameKey: 'noseCone', correctSlot: 0, color: '#e74c3c', shape: 'cone', icon: 'â–²' },
            { id: 'payload', nameKey: 'payload', correctSlot: 1, color: '#3498db', shape: 'cylinder', icon: 'â¬›' },
            { id: 'fuel_tank', nameKey: 'fuelTank', correctSlot: 2, color: '#f39c12', shape: 'cylinder', icon: 'â¬›' },
            { id: 'oxidizer', nameKey: 'oxidizer', correctSlot: 3, color: '#9b59b6', shape: 'cylinder', icon: 'â¬›' },
            { id: 'engine', nameKey: 'engine', correctSlot: 4, color: '#1abc9c', shape: 'bell', icon: 'ğŸ””' },
            { id: 'fins', nameKey: 'fins', correctSlot: 5, color: '#e67e22', shape: 'fins', icon: 'â—†' }
        ];

        const TURBINE_PARTS = [
            { id: 'intake', nameKey: 'intake', correctSlot: 0, color: '#3498db', shape: 'intake', icon: 'â—¯' },
            { id: 'compressor', nameKey: 'compressor', correctSlot: 1, color: '#9b59b6', shape: 'blades', icon: 'âœ±' },
            { id: 'combustion', nameKey: 'combustion', correctSlot: 2, color: '#e74c3c', shape: 'chamber', icon: 'â–£' },
            { id: 'turbine_blades', nameKey: 'turbineBlades', correctSlot: 3, color: '#f39c12', shape: 'blades', icon: 'âœ±' },
            { id: 'shaft', nameKey: 'shaft', correctSlot: 4, color: '#7f8c8d', shape: 'shaft', icon: 'â”‚' },
            { id: 'exhaust', nameKey: 'exhaust', correctSlot: 5, color: '#1abc9c', shape: 'nozzle', icon: 'â–½' }
        ];

        // Helper to get part name in current language
        function getPartName(part) {
            return t(part.nameKey);
        }

        function shuffleArray(array) {
            const shuffled = [...array];
            for (let i = shuffled.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
            }
            return shuffled;
        }

        function getParts() {
            return gameMode === 'rocket' ? ROCKET_PARTS : TURBINE_PARTS;
        }

        function startGame(mode) {
            playClick();
            stopBackgroundMusic();
            setTimeout(() => startBackgroundMusic(), 300);

            gameMode = mode;
            gameState = 'assembly';
            lives = 3;
            score = 0;
            placedParts = {};
            selectedPart = null;
            placementHistory = [];
            lockedSlots = new Set();
            result = null;
            shuffledParts = shuffleArray(getParts());

            document.getElementById('menu-screen').style.display = 'none';
            document.getElementById('game-screen').style.display = 'block';

            document.getElementById('game-mode-title').textContent = mode === 'rocket' ? `ğŸš€ ${t('rocketMode')}` : `âœˆï¸ ${t('turbineMode')}`;
            document.getElementById('hint-text').textContent = mode === 'rocket' ? t('rocketHint') : t('turbineHint');

            initThreeJS();
            updateUI();

            // Show tutorial for first-time players
            if (checkFirstTime()) {
                setTimeout(() => showTutorial(), 500);
            }
        }

        function goToMenu() {
            playClick();
            stopBackgroundMusic();

            gameState = 'menu';
            if (animationId) cancelAnimationFrame(animationId);
            if (renderer) renderer.dispose();

            document.getElementById('menu-screen').style.display = 'flex';
            document.getElementById('game-screen').style.display = 'none';
        }

        function initThreeJS() {
            const container = document.getElementById('game-canvas');
            container.innerHTML = '';

            const width = container.clientWidth;
            const height = container.clientHeight;

            scene = new THREE.Scene();
            scene.background = new THREE.Color(0x0a0a1a);

            // CHANGED: Camera Z is now -12 to view from back
            camera = new THREE.PerspectiveCamera(60, width / height, 0.1, 1000);
            camera.position.set(0, 2, -12);
            camera.lookAt(0, 0, 0);

            renderer = new THREE.WebGLRenderer({ antialias: true });
            renderer.setSize(width, height);
            renderer.setPixelRatio(window.devicePixelRatio);
            renderer.shadowMap.enabled = true;
            container.appendChild(renderer.domElement);

            // Lights
            const ambientLight = new THREE.AmbientLight(0x404060, 0.5);
            scene.add(ambientLight);

            // CHANGED: Lights moved to negative Z
            const directionalLight = new THREE.DirectionalLight(0xffffff, 1);
            directionalLight.position.set(5, 10, -5);
            scene.add(directionalLight);

            const pointLight = new THREE.PointLight(0x00ffff, 0.5);
            pointLight.position.set(-5, 5, -5);
            scene.add(pointLight);

            // Stars
            const starsGeometry = new THREE.BufferGeometry();
            const starsVertices = [];
            for (let i = 0; i < 2000; i++) {
                starsVertices.push(
                    (Math.random() - 0.5) * 100,
                    (Math.random() - 0.5) * 100,
                    (Math.random() - 0.5) * 100
                );
            }
            starsGeometry.setAttribute('position', new THREE.Float32BufferAttribute(starsVertices, 3));
            const starsMaterial = new THREE.PointsMaterial({ color: 0xffffff, size: 0.05 });
            const stars = new THREE.Points(starsGeometry, starsMaterial);
            scene.add(stars);

            // Platform
            const platformGeometry = new THREE.CylinderGeometry(4, 4.5, 0.5, 32);
            const platformMaterial = new THREE.MeshStandardMaterial({ color: 0x2c3e50, metalness: 0.8, roughness: 0.2 });
            const platform = new THREE.Mesh(platformGeometry, platformMaterial);
            platform.position.y = -4;
            scene.add(platform);

            // Assembly slots
            createAssemblySlots();

            // Animation loop
            function animate() {
                animationId = requestAnimationFrame(animate);
                stars.rotation.y += 0.0001;
                renderer.render(scene, camera);
            }
            animate();

            // Resize handler
            window.addEventListener('resize', () => {
                if (!container) return;
                const w = container.clientWidth;
                const h = container.clientHeight;
                camera.aspect = w / h;
                camera.updateProjectionMatrix();
                renderer.setSize(w, h);
            });
        }

        function createAssemblySlots() {
            const positions = gameMode === 'rocket'
                ? [{ y: 3 }, { y: 1.8 }, { y: 0.6 }, { y: -0.6 }, { y: -1.8 }, { y: -3 }]
                : [{ x: -4 }, { x: -2.4 }, { x: -0.8 }, { x: 0.8 }, { x: 2.4 }, { x: 4 }];

            positions.forEach((pos, index) => {
                const geometry = gameMode === 'rocket'
                    ? new THREE.TorusGeometry(0.8, 0.05, 8, 32)
                    : new THREE.BoxGeometry(1.4, 1.4, 0.1);

                const material = new THREE.MeshStandardMaterial({
                    color: 0x00ff88,
                    transparent: true,
                    opacity: 0.4,
                    emissive: 0x00ff44,
                    emissiveIntensity: 0.3
                });

                const slot = new THREE.Mesh(geometry, material);

                if (gameMode === 'rocket') {
                    slot.position.set(0, pos.y, 0);
                    slot.rotation.x = Math.PI / 2;
                } else {
                    slot.position.set(pos.x, 0, 0);
                }

                scene.add(slot);
            });
        }

        function createPartMesh(part) {
            const material = new THREE.MeshStandardMaterial({
                color: part.color,
                metalness: 0.6,
                roughness: 0.3
            });

            let mesh;

            switch (part.shape) {
                case 'cone':
                    mesh = new THREE.Mesh(new THREE.ConeGeometry(0.6, 1.2, 32), material);
                    break;
                case 'cylinder':
                    mesh = new THREE.Mesh(new THREE.CylinderGeometry(0.7, 0.7, 1, 32), material);
                    break;
                case 'bell':
                    mesh = new THREE.Mesh(new THREE.ConeGeometry(0.8, 1.2, 32), material);
                    break;
                case 'fins':
                    mesh = new THREE.Group();
                    for (let i = 0; i < 4; i++) {
                        const fin = new THREE.Mesh(new THREE.BoxGeometry(0.1, 0.8, 0.6), material);
                        fin.position.set(Math.cos(i * Math.PI / 2) * 0.7, 0, Math.sin(i * Math.PI / 2) * 0.7);
                        fin.rotation.y = i * Math.PI / 2;
                        mesh.add(fin);
                    }
                    break;
                case 'intake':
                    mesh = new THREE.Mesh(new THREE.CylinderGeometry(0.5, 0.7, 1, 32, 1, true), material);
                    break;
                case 'blades':
                    mesh = new THREE.Group();
                    const hub = new THREE.Mesh(new THREE.CylinderGeometry(0.2, 0.2, 0.3, 16), material);
                    hub.rotation.z = Math.PI / 2;
                    mesh.add(hub);
                    for (let i = 0; i < 8; i++) {
                        const blade = new THREE.Mesh(new THREE.BoxGeometry(0.6, 0.05, 0.15), material);
                        blade.position.set(0.35, 0, 0);
                        const pivot = new THREE.Group();
                        pivot.add(blade);
                        pivot.rotation.z = Math.PI / 2;
                        pivot.rotation.y = (i * Math.PI) / 4;
                        mesh.add(pivot);
                    }
                    break;
                case 'chamber':
                    mesh = new THREE.Mesh(new THREE.CylinderGeometry(0.6, 0.6, 1.2, 32), material);
                    break;
                case 'shaft':
                    mesh = new THREE.Mesh(new THREE.CylinderGeometry(0.15, 0.15, 2, 16), material);
                    break;
                case 'nozzle':
                    mesh = new THREE.Mesh(new THREE.ConeGeometry(0.7, 1.2, 32, 1, true), material);
                    break;
                default:
                    mesh = new THREE.Mesh(new THREE.BoxGeometry(0.8, 0.8, 0.8), material);
            }

            return mesh;
        }

        function selectPart(part) {
            if (gameState !== 'assembly') return;
            playSelect();
            selectedPart = part;
            updateUI();
        }

        function placePart(slotIndex) {
            if (!selectedPart || placedParts[slotIndex] || lockedSlots.has(slotIndex) || gameState !== 'assembly') return;

            playPlace();

            const mesh = createPartMesh(selectedPart);

            if (gameMode === 'rocket') {
                const yPositions = [3, 1.8, 0.6, -0.6, -1.8, -3];
                mesh.position.set(0, yPositions[slotIndex], 0);
                if (selectedPart.shape === 'bell') {
                    mesh.rotation.x = Math.PI;
                }
            } else {
                const xPositions = [-4, -2.4, -0.8, 0.8, 2.4, 4];
                mesh.position.set(xPositions[slotIndex], 0, 0);
                mesh.rotation.z = Math.PI / 2;
            }

            scene.add(mesh);
            objects[slotIndex] = mesh;

            placementHistory.push({ slotIndex, part: selectedPart });
            placedParts[slotIndex] = selectedPart;
            shuffledParts = shuffledParts.filter(p => p.id !== selectedPart.id);
            selectedPart = null;

            updateUI();
        }

        function undoLastPlacement() {
            if (placementHistory.length === 0) return;

            playClick();

            for (let i = placementHistory.length - 1; i >= 0; i--) {
                const placement = placementHistory[i];
                if (!lockedSlots.has(placement.slotIndex)) {
                    if (objects[placement.slotIndex]) {
                        scene.remove(objects[placement.slotIndex]);
                        delete objects[placement.slotIndex];
                    }

                    delete placedParts[placement.slotIndex];
                    shuffledParts.push(placement.part);
                    placementHistory = placementHistory.filter((_, index) => index !== i);
                    selectedPart = null;

                    updateUI();
                    return;
                }
            }
        }

        function checkAssembly() {
            const baseParts = getParts();
            if (Object.keys(placedParts).length !== baseParts.length) {
                alert(t('placeAllParts'));
                return;
            }

            const correctPlacements = {};
            const incorrectSlots = [];
            const incorrectParts = [];
            const newLockedSlots = new Set(lockedSlots);

            Object.entries(placedParts).forEach(([slotIndex, part]) => {
                const slot = parseInt(slotIndex);
                if (part.correctSlot === slot) {
                    correctPlacements[slot] = part;
                    newLockedSlots.add(slot);
                } else {
                    incorrectSlots.push(slot);
                    incorrectParts.push(part);
                }
            });

            if (incorrectSlots.length === 0) {
                result = 'success';
                score += 100;
                gameState = 'result';
                playSuccess();
                animateSuccess();
            } else {
                lockedSlots = newLockedSlots;

                incorrectSlots.forEach(slotIndex => {
                    if (objects[slotIndex]) {
                        scene.remove(objects[slotIndex]);
                        delete objects[slotIndex];
                    }
                });

                placedParts = correctPlacements;
                shuffledParts = shuffleArray(incorrectParts);
                placementHistory = placementHistory.filter(item => newLockedSlots.has(item.slotIndex));

                lives--;

                if (lives <= 0) {
                    result = 'failure';
                    gameState = 'result';
                    playFailure();
                    animateFailure();
                } else {
                    result = 'partial';
                    playPartial();
                    setTimeout(() => {
                        result = null;
                        updateUI();
                    }, 2000);
                }
            }

            updateUI();
        }

        function createAirplane() {
            const planeGroup = new THREE.Group();
            const fuselageMaterial = new THREE.MeshStandardMaterial({ color: 0xcccccc, metalness: 0.7, roughness: 0.3 });
            const wingMaterial = new THREE.MeshStandardMaterial({ color: 0x95a5a6, metalness: 0.6, roughness: 0.4 });
            const cockpitMaterial = new THREE.MeshStandardMaterial({ color: 0x3498db, metalness: 0.9, roughness: 0.1 });

            // Fuselage
            const fuselage = new THREE.Mesh(new THREE.CylinderGeometry(0.4, 0.3, 4, 16), fuselageMaterial);
            fuselage.rotation.z = Math.PI / 2;
            planeGroup.add(fuselage);

            // Nose
            const nose = new THREE.Mesh(new THREE.ConeGeometry(0.3, 0.8, 16), fuselageMaterial);
            nose.rotation.z = -Math.PI / 2;
            nose.position.x = 2.4;
            planeGroup.add(nose);

            // Cockpit
            const cockpit = new THREE.Mesh(new THREE.SphereGeometry(0.25, 16, 16), cockpitMaterial);
            cockpit.position.set(1.2, 0.3, 0);
            cockpit.scale.set(1, 0.7, 0.8);
            planeGroup.add(cockpit);

            // Wings
            const leftWing = new THREE.Mesh(new THREE.BoxGeometry(0.8, 0.05, 3), wingMaterial);
            leftWing.position.set(0, 0, 1.5);
            planeGroup.add(leftWing);
            const rightWing = new THREE.Mesh(new THREE.BoxGeometry(0.8, 0.05, 3), wingMaterial);
            rightWing.position.set(0, 0, -1.5);
            planeGroup.add(rightWing);

            // Tail
            const tail = new THREE.Mesh(new THREE.BoxGeometry(0.5, 0.8, 0.05), wingMaterial);
            tail.position.set(-1.8, 0.4, 0);
            planeGroup.add(tail);

            // Stabilizer
            const stabilizer = new THREE.Mesh(new THREE.BoxGeometry(0.4, 0.05, 1.2), wingMaterial);
            stabilizer.position.set(-1.8, 0, 0);
            planeGroup.add(stabilizer);

            return planeGroup;
        }

        function animateSuccess() {
            Object.values(objects).forEach(mesh => {
                if (mesh) scene.remove(mesh);
            });

            if (gameMode === 'rocket') {
                const vehicleGroup = new THREE.Group();
                const baseParts = getParts();

                // Roketi oluÅŸtur
                baseParts.forEach((part, index) => {
                    const mesh = createPartMesh(part);
                    const yPositions = [3, 1.8, 0.6, -0.6, -1.8, -3];
                    mesh.position.set(0, yPositions[index], 0);
                    if (part.shape === 'bell') mesh.rotation.x = Math.PI;
                    vehicleGroup.add(mesh);
                });

                scene.add(vehicleGroup);

                // Motor IÅŸÄ±ÄŸÄ± (Glow)
                const engineGlow = new THREE.PointLight(0xff4400, 3, 10);
                engineGlow.position.set(0, -4, 0);
                vehicleGroup.add(engineGlow);

                // AteÅŸ PartikÃ¼lleri
                const particleCount = 200;
                const particlesGeometry = new THREE.BufferGeometry();
                const particlePositions = new Float32Array(particleCount * 3);
                for (let i = 0; i < particleCount; i++) {
                    particlePositions[i * 3] = (Math.random() - 0.5) * 1.0; // X
                    particlePositions[i * 3 + 1] = -4 - Math.random() * 2; // Y (Motorun altÄ±)
                    particlePositions[i * 3 + 2] = (Math.random() - 0.5) * 1.0; // Z
                }
                particlesGeometry.setAttribute('position', new THREE.Float32BufferAttribute(particlePositions, 3));
                const particlesMaterial = new THREE.PointsMaterial({ color: 0xffaa00, size: 0.3, transparent: true, opacity: 0.8 });
                const particles = new THREE.Points(particlesGeometry, particlesMaterial);
                vehicleGroup.add(particles);

                // Duman
                const smokeCount = 100;
                const smokeGeometry = new THREE.BufferGeometry();
                const smokePositions = new Float32Array(smokeCount * 3);
                for (let i = 0; i < smokeCount; i++) {
                    smokePositions[i * 3] = (Math.random() - 0.5) * 2;
                    smokePositions[i * 3 + 1] = -5 - Math.random() * 5;
                    smokePositions[i * 3 + 2] = (Math.random() - 0.5) * 2;
                }
                smokeGeometry.setAttribute('position', new THREE.Float32BufferAttribute(smokePositions, 3));
                const smokeMaterial = new THREE.PointsMaterial({ color: 0x555555, size: 0.8, transparent: true, opacity: 0.4 });
                const smoke = new THREE.Points(smokeGeometry, smokeMaterial);
                vehicleGroup.add(smoke);

                let velocity = 0;
                let time = 0;
                let phase = 'ignition';

                // KamerayÄ± baÅŸlangÄ±Ã§ pozisyonuna al
                camera.position.set(0, 2, 14);
                camera.lookAt(0, 0, 0);

                // Sesi baÅŸlat
                playRocketLaunch();

                function launchAnimation() {
                    time += 0.016;

                    // YÄ±ldÄ±zlarÄ± (scene.children iÃ§indeki Points objesini) bul ve kamera ile yukarÄ± taÅŸÄ±
                    // Bu sayede yÄ±ldÄ±zlar hiÃ§ bitmez
                    scene.children.forEach(child => {
                        if (child.type === 'Points' && child !== particles && child !== smoke) {
                            child.position.y = vehicleGroup.position.y;
                        }
                    });

                    if (time < 10) { // Animasyon sÃ¼resini uzattÄ±k
                        if (phase === 'ignition' && time < 1.0) {
                            // AteÅŸleme: Titreme efekti
                            vehicleGroup.position.x = (Math.random() - 0.5) * 0.1;
                            vehicleGroup.position.z = (Math.random() - 0.5) * 0.1;
                            engineGlow.intensity = 2 + Math.random() * 3;

                        } else if (time >= 1.0 && time < 3.0) {
                            // KalkÄ±ÅŸ: YavaÅŸÃ§a yÃ¼kselme
                            phase = 'liftoff';
                            velocity += 0.005;
                            vehicleGroup.position.y += velocity;

                            // Hafif titreme
                            vehicleGroup.position.x = (Math.random() - 0.5) * 0.05;

                            // Kamera takibi (YavaÅŸÃ§a aÅŸaÄŸÄ±dan bakarak takip et)
                            camera.position.y = vehicleGroup.position.y + 2;
                            camera.lookAt(0, vehicleGroup.position.y + 2, 0);

                        } else if (time >= 3.0 && time < 6.0) {
                            // YÃ¼kseliÅŸ: HÄ±zlanma
                            phase = 'ascent';
                            velocity += 0.01;
                            vehicleGroup.position.y += velocity;

                            // Kamera takibi (Biraz uzaklaÅŸarak)
                            camera.position.y = vehicleGroup.position.y;
                            camera.position.z = 14 + (time - 3); // Biraz uzaklaÅŸ
                            camera.lookAt(0, vehicleGroup.position.y, 0);

                            // DÃ¶nÃ¼ÅŸ efekti
                            vehicleGroup.rotation.y += 0.005;

                        } else {
                            // Uzay: SÃ¼zÃ¼lme ve DÃ¶nme
                            phase = 'space';
                            velocity = 0.4; // Sabit yÃ¼ksek hÄ±z
                            vehicleGroup.position.y += velocity;

                            // Kamera rokete kilitlensin
                            camera.position.y = vehicleGroup.position.y + 2;
                            camera.lookAt(0, vehicleGroup.position.y, 0);

                            // Roket hafif yatsÄ±n (Gravity Turn)
                            if (vehicleGroup.rotation.z > -0.5) {
                                vehicleGroup.rotation.z -= 0.002;
                            }

                            // Motoru kÄ±s
                            engineGlow.intensity = Math.max(0, 5 - (time - 6));
                            particlesMaterial.opacity = Math.max(0, 1 - (time - 6));
                            smokeMaterial.opacity = 0;
                        }

                        // AteÅŸ partikÃ¼llerini gÃ¼ncelle (Her zaman aÅŸaÄŸÄ± doÄŸru)
                        const pPos = particles.geometry.attributes.position.array;
                        for (let i = 0; i < particleCount; i++) {
                            // PartikÃ¼lleri aÅŸaÄŸÄ± it
                            pPos[i * 3 + 1] -= 0.5 + Math.random() * 0.5;

                            // Ã‡ok aÅŸaÄŸÄ± gittiyse motorun aÄŸzÄ±na geri Ä±ÅŸÄ±nla
                            if (pPos[i * 3 + 1] < -4 - (velocity * 10)) {
                                pPos[i * 3] = (Math.random() - 0.5) * 1.0;
                                pPos[i * 3 + 1] = -3.5;
                                pPos[i * 3 + 2] = (Math.random() - 0.5) * 1.0;
                            }
                        }
                        particles.geometry.attributes.position.needsUpdate = true;

                        // DumanÄ± gÃ¼ncelle
                        const sPos = smoke.geometry.attributes.position.array;
                        for (let i = 0; i < smokeCount; i++) {
                            sPos[i * 3 + 1] -= 0.2; // Duman aÅŸaÄŸÄ± iner
                            if (sPos[i * 3 + 1] < -10) {
                                sPos[i * 3 + 1] = -4; // Reset
                            }
                        }
                        smoke.geometry.attributes.position.needsUpdate = true;

                        requestAnimationFrame(launchAnimation);
                    } else {
                        setTimeout(() => showEducationalContent(), 500);
                    }
                }

                setTimeout(launchAnimation, 500);

            } else {
                // Turbine mode - airplane
                const baseParts = getParts();
                const engineGroup = new THREE.Group();

                baseParts.forEach((part, index) => {
                    const mesh = createPartMesh(part);
                    const xPositions = [-2, -1.2, -0.4, 0.4, 1.2, 2];
                    mesh.position.set(xPositions[index], 0, 0);
                    mesh.rotation.z = Math.PI / 2;
                    mesh.scale.set(0.6, 0.6, 0.6);
                    engineGroup.add(mesh);
                });

                const airplane = createAirplane();
                airplane.position.set(-6, -2, 0);
                airplane.scale.set(1.2, 1.2, 1.2);
                airplane.rotation.y = 0; // Face right (towards +X)
                scene.add(airplane);

                engineGroup.position.set(0, -0.5, 1.5);
                engineGroup.scale.set(0.4, 0.4, 0.4);

                // CHANGED: Rotated engine 180 degrees to face correct way (left)
                engineGroup.rotation.set(-1, Math.PI, 0);
                airplane.add(engineGroup);

                const engineGroup2 = engineGroup.clone();
                engineGroup2.position.set(0, -0.5, -1.5);
                airplane.add(engineGroup2);

                // CHANGED: Engine glow position X changed from 1 to -2 (back of engine)
                const engineGlow1 = new THREE.PointLight(0xff6600, 2, 3);
                engineGlow1.position.set(-2, -0.5, 1.5);
                airplane.add(engineGlow1);

                const engineGlow2 = new THREE.PointLight(0xff6600, 2, 3);
                engineGlow2.position.set(-2, -0.5, -1.5);
                airplane.add(engineGlow2);

                // Exhaust particles
                // CHANGED: Particles now start at -2 (back)
                function createExhaust(zPos) {
                    const exhaustCount = 40;
                    const exhaustGeometry = new THREE.BufferGeometry();
                    const exhaustPositions = new Float32Array(exhaustCount * 3);
                    for (let i = 0; i < exhaustCount; i++) {
                        exhaustPositions[i * 3] = -2 - Math.random() * 1.5;
                        exhaustPositions[i * 3 + 1] = -0.5 + (Math.random() - 0.5) * 0.2;
                        exhaustPositions[i * 3 + 2] = zPos + (Math.random() - 0.5) * 0.2;
                    }
                    exhaustGeometry.setAttribute('position', new THREE.Float32BufferAttribute(exhaustPositions, 3));
                    const exhaustMaterial = new THREE.PointsMaterial({ color: 0xff4400, size: 0.08, transparent: true, opacity: 0.8 });
                    return { particles: new THREE.Points(exhaustGeometry, exhaustMaterial), geometry: exhaustGeometry, zPos };
                }

                const exhaust1 = createExhaust(1.5);
                const exhaust2 = createExhaust(-1.5);
                airplane.add(exhaust1.particles);
                airplane.add(exhaust2.particles);

                // CHANGED: Camera still looks from back (-Z) but follows airplane
                camera.position.set(0, 4, -14);
                camera.lookAt(0, 0, 0);

                let time = 0;
                let phase = 'startup';

                // Play turbine spinup sound
                playTurbineSpinup();

                function flyAnimation() {
                    time += 0.016;

                    if (time < 10) {
                        if (phase === 'startup' && time < 1.5) {
                            airplane.position.z += Math.sin(time * 30) * 0.003;
                            engineGlow1.intensity = engineGlow2.intensity = time * 2;
                        } else if (time >= 1.5 && time < 3) {
                            phase = 'taxi';
                            airplane.position.x += 0.04;
                            airplane.rotation.x = Math.sin(time * 10) * 0.01;
                            engineGlow1.intensity = engineGlow2.intensity = 2.5;
                        } else if (time >= 3 && time < 4.5) {
                            phase = 'takeoff_roll';
                            airplane.position.x += 0.1 + (time - 3) * 0.06;
                            engineGlow1.intensity = engineGlow2.intensity = 3;
                        } else if (time >= 4.5 && time < 6) {
                            phase = 'rotate';
                            airplane.position.x += 0.18;
                            airplane.position.y += 0.06;
                            airplane.rotation.z = 0.2 + (time - 4.5) * 0.1; // Pitch up
                        } else if (time >= 6 && time < 8) {
                            phase = 'climb';
                            airplane.position.x += 0.15;
                            airplane.position.y += 0.12;
                            airplane.rotation.z = 0.3;
                            airplane.rotation.x = Math.sin(time * 2) * 0.05;
                            camera.position.x += 0.1;
                            camera.position.y += 0.06;
                            camera.lookAt(airplane.position);
                        } else {
                            phase = 'cruise';
                            airplane.position.x += 0.18;
                            airplane.position.y += Math.sin(time * 1.5) * 0.03;
                            airplane.rotation.z = 0.15 + Math.sin(time * 2) * 0.1;
                            airplane.rotation.x = Math.sin(time * 1.5) * 0.08;
                            camera.position.x += 0.12;
                            camera.lookAt(airplane.position);
                        }

                        // Update exhaust
                        // CHANGED: Logic reversed for backwards particles
                        [exhaust1, exhaust2].forEach(exhaust => {
                            const positions = exhaust.geometry.attributes.position.array;
                            const count = positions.length / 3;
                            for (let i = 0; i < count; i++) {
                                positions[i * 3] -= 0.15; // Move backwards
                                if (positions[i * 3] < -6) { // Check if too far back
                                    positions[i * 3] = -2; // Reset
                                    positions[i * 3 + 1] = -0.5 + (Math.random() - 0.5) * 0.2;
                                    positions[i * 3 + 2] = exhaust.zPos + (Math.random() - 0.5) * 0.2;
                                }
                            }
                            exhaust.geometry.attributes.position.needsUpdate = true;
                        });

                        requestAnimationFrame(flyAnimation);
                    } else {
                        // Animation complete - show educational content
                        setTimeout(() => showEducationalContent(), 500);
                    }
                }

                setTimeout(flyAnimation, 500);
            }
        }

        function animateFailure() {
            const vehicleGroup = new THREE.Group();

            Object.values(objects).forEach(mesh => {
                if (mesh) {
                    const clone = mesh.clone();
                    vehicleGroup.add(clone);
                    scene.remove(mesh);
                }
            });

            scene.add(vehicleGroup);

            const explosionPieces = [];
            vehicleGroup.children.forEach(child => {
                explosionPieces.push({
                    mesh: child,
                    velocity: new THREE.Vector3(
                        (Math.random() - 0.5) * 0.3,
                        Math.random() * 0.2,
                        (Math.random() - 0.5) * 0.3
                    ),
                    rotationSpeed: new THREE.Vector3(
                        Math.random() * 0.2,
                        Math.random() * 0.2,
                        Math.random() * 0.2
                    )
                });
            });

            // Explosion particles
            const explosionCount = 200;
            const explosionGeometry = new THREE.BufferGeometry();
            const explosionPositions = new Float32Array(explosionCount * 3);
            const explosionVelocities = [];

            for (let i = 0; i < explosionCount; i++) {
                explosionPositions[i * 3] = 0;
                explosionPositions[i * 3 + 1] = 0;
                explosionPositions[i * 3 + 2] = 0;
                explosionVelocities.push(new THREE.Vector3(
                    (Math.random() - 0.5) * 0.5,
                    (Math.random() - 0.5) * 0.5,
                    (Math.random() - 0.5) * 0.5
                ));
            }
            explosionGeometry.setAttribute('position', new THREE.Float32BufferAttribute(explosionPositions, 3));
            const explosionMaterial = new THREE.PointsMaterial({ color: 0xff4400, size: 0.2, transparent: true, opacity: 1 });
            const explosionParticles = new THREE.Points(explosionGeometry, explosionMaterial);
            scene.add(explosionParticles);

            let time = 0;

            function explodeAnimation() {
                time += 0.016;

                if (time < 3) {
                    explosionPieces.forEach(piece => {
                        piece.mesh.position.add(piece.velocity);
                        piece.velocity.y -= 0.01;
                        piece.mesh.rotation.x += piece.rotationSpeed.x;
                        piece.mesh.rotation.y += piece.rotationSpeed.y;
                        piece.mesh.rotation.z += piece.rotationSpeed.z;
                    });

                    const positions = explosionParticles.geometry.attributes.position.array;
                    for (let i = 0; i < explosionCount; i++) {
                        positions[i * 3] += explosionVelocities[i].x;
                        positions[i * 3 + 1] += explosionVelocities[i].y;
                        positions[i * 3 + 2] += explosionVelocities[i].z;
                        explosionVelocities[i].y -= 0.005;
                    }
                    explosionParticles.geometry.attributes.position.needsUpdate = true;
                    explosionMaterial.opacity = Math.max(0, 1 - time / 2);

                    requestAnimationFrame(explodeAnimation);
                }
            }

            setTimeout(explodeAnimation, 100);
        }

        function resetGame() {
            playClick();

            placedParts = {};
            selectedPart = null;
            placementHistory = [];
            result = null;
            objects = {};

            if (lives > 0) {
                lockedSlots = new Set();
                shuffledParts = shuffleArray(getParts());
                gameState = 'assembly';

                // Reinitialize 3D scene
                if (animationId) cancelAnimationFrame(animationId);
                initThreeJS();
            } else {
                lives = 3;
                score = 0;
                lockedSlots = new Set();
                goToMenu();
            }

            updateUI();
        }

        function updateUI() {
            // Hearts
            const heartsHtml = Array(3).fill(0).map((_, i) =>
                `<span class="heart ${i >= lives ? 'empty' : ''}">â¤ï¸</span>`
            ).join('');
            document.getElementById('hearts-display').innerHTML = heartsHtml;

            // Score
            document.getElementById('score-display').textContent = `â­ ${score}`;

            // Locked parts section
            const lockedSection = document.getElementById('locked-parts-section');
            const lockedList = document.getElementById('locked-parts-list');
            if (lockedSlots.size > 0) {
                lockedSection.style.display = 'block';
                lockedList.innerHTML = Array.from(lockedSlots).map(slot => {
                    const part = placedParts[slot];
                    return part ? `
                        <div class="locked-item">
                            <div class="color-dot" style="background: ${part.color}"></div>
                            <span>${getPartName(part)}</span>
                        </div>
                    ` : '';
                }).join('');
            } else {
                lockedSection.style.display = 'none';
            }

            // Parts list
            const partsList = document.getElementById('parts-list');
            partsList.innerHTML = shuffledParts.map(part => `
                <button class="part-btn ${selectedPart?.id === part.id ? 'selected' : ''} ${gameState !== 'assembly' ? 'disabled' : ''}"
                        onclick="selectPart(${JSON.stringify(part).replace(/"/g, '&quot;')})">
                    <div class="part-content">
                        <div class="part-icon" style="background: ${part.color}">${part.icon}</div>
                        <div class="part-info">
                            <div class="part-name">${getPartName(part)}</div>
                            <div class="part-status">${t('ready')}</div>
                        </div>
                    </div>
                </button>
            `).join('');

            // Empty message
            document.getElementById('empty-parts-message').style.display =
                shuffledParts.length === 0 && Object.keys(placedParts).length < 6 ? 'block' : 'none';

            // Undo button
            const hasUndoable = placementHistory.some(item => !lockedSlots.has(item.slotIndex));
            document.getElementById('undo-btn').style.display =
                gameState === 'assembly' && hasUndoable ? 'block' : 'none';

            // Check/Retry button
            document.getElementById('check-btn').style.display = gameState === 'assembly' ? 'block' : 'none';
            document.getElementById('retry-btn').style.display = gameState === 'result' ? 'block' : 'none';
            document.getElementById('retry-btn').textContent = lives > 0 ? t('retryBtn') : t('menuBtn');

            // Selection info
            const selectionInfo = document.getElementById('selection-info');
            if (selectedPart && gameState === 'assembly') {
                selectionInfo.style.display = 'block';
                document.getElementById('selected-part-name').textContent = getPartName(selectedPart);
            } else {
                selectionInfo.style.display = 'none';
            }

            // Slots
            const slotsList = document.getElementById('slots-list');
            slotsList.innerHTML = [0, 1, 2, 3, 4, 5].map(slotIndex => {
                const placedPart = placedParts[slotIndex];
                const isLocked = lockedSlots.has(slotIndex);

                let className = 'slot-btn';
                if (isLocked) className += ' locked';
                else if (placedPart) className += ' filled';
                else if (selectedPart) className += ' active';
                else className += ' disabled';

                return `
                    <button class="${className}" onclick="placePart(${slotIndex})">
                        <div class="slot-content">
                            <span class="slot-label ${isLocked ? 'locked' : ''}">
                                ${t('slot')} ${slotIndex + 1} ${isLocked ? 'ğŸ”’' : ''}
                            </span>
                            ${placedPart ? `
                                <div class="slot-part">
                                    <div class="color-dot" style="background: ${placedPart.color}"></div>
                                    <span class="slot-part-name ${isLocked ? 'locked' : ''}">${getPartName(placedPart)}</span>
                                </div>
                            ` : `
                                <span class="slot-empty">${t('empty')}</span>
                            `}
                        </div>
                    </button>
                `;
            }).join('');

            // Result overlay
            const resultOverlay = document.getElementById('result-overlay');
            const resultBox = document.getElementById('result-box');

            if (result) {
                resultOverlay.style.display = 'flex';
                resultBox.className = `result-box ${result}`;

                const icons = { success: 'ğŸ‰', partial: 'ğŸ”§', failure: 'ğŸ’¥' };
                const titles = { success: t('successTitle'), partial: t('partialTitle'), failure: t('failureTitle') };

                let message;
                if (result === 'success') {
                    message = gameMode === 'rocket' ? t('rocketSuccess') : t('turbineSuccess');
                } else if (result === 'partial') {
                    message = `${t('partialMsg')} ${lives} ${t('livesLeft')}.`;
                } else {
                    message = lives > 0 ? `${t('failureMsg')} ${lives} ${t('livesLeft')}.` : t('gameOver');
                }

                document.getElementById('result-icon').textContent = icons[result];
                document.getElementById('result-title').textContent = titles[result];
                document.getElementById('result-title').className = `result-title ${result}`;
                document.getElementById('result-message').textContent = message;
            } else {
                resultOverlay.style.display = 'none';
            }
        }

        // Initialize language on page load
        document.addEventListener('DOMContentLoaded', () => {
            document.getElementById('lang-toggle').textContent = currentLanguage === 'tr' ? 'ğŸŒ EN' : 'ğŸŒ TR';
            updateLanguage();
        });

    </script>
</body>

</html>